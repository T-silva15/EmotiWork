@page
@model EmotiWork.Pages.Backoffice.AdminStatisticsModel
@{
    ViewData["Title"] = "Estatísticas Admin - EmotiWork";
    Layout = null;
}

<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/landing.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/sidebar.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/backoffice.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/backoffice-admin-statistics.css" asp-append-version="true" />
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <!-- Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Adding accessibility styles */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Fix contrast issues */
        .card-icon {
            color: #2e86c1; /* Darker blue for better contrast */
        }

        .export-btn {
            background-color: #2e86c1; /* Darker blue for better contrast */
        }

            .export-btn:hover {
                background-color: #1e6091;
            }

        .recommendations-info-btn {
            color: #2e86c1; /* Darker blue for better contrast */
        }

        .recommendation-icon {
            color: #2e86c1; /* Darker blue for better contrast */
        }

        .view-all-recommendations-btn {
            background-color: #2e86c1;
        }

            .view-all-recommendations-btn:hover {
                background-color: #1e6091;
            }

        .filter-btn.active {
            background-color: #2e86c1;
            border-color: #2e86c1;
        }

        /* Progress bar colors */
        .progress-bar.high {
            background-color: #0D6E1E; /* Darker green for better contrast */
        }

        .progress-bar.medium {
            background-color: #2e86c1; /* Darker blue for better contrast */
        }

        .progress-bar.low {
            background-color: #c0392b; /* Darker red for better contrast */
        }
    </style>
</head>
<body class="home-body">
    <!-- Left Sidebar -->
    <aside class="sidebar-left">
        <nav class="sidebar-nav">
            <ul class="nav-items">
                <li class="nav-item">
                    <a href="/Team" class="nav-link" aria-label="Equipa">
                        <i class="fas fa-users"></i>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="/Dashboard" class="nav-link" aria-label="Dashboard">
                        <i class="fas fa-gauge-high"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Questionnaire" class="nav-link" aria-label="Questionário">
                        <i class="fas fa-circle-question"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Statistics" class="nav-link" aria-label="Estatísticas">
                        <i class="fas fa-chart-line"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Notifications" class="nav-link" aria-label="Notificações">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Reports" class="nav-link" aria-label="Relatórios">
                        <i class="fas fa-user-secret"></i>
                    </a>
                </li>
                <li class="nav-item nav-item-bottom">
                    <a href="/Settings" class="nav-link" aria-label="Definições">
                        <i class="fas fa-gear"></i>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="logo-container">
                <a href="/Home" class="logo-link">
                    <img src="~/img/emotiwork.png" alt="EmotiWork Logo" class="logo-img" />
                    <span class="logo-text">EmotiWork</span>
                </a>
            </div>
            <div class="user-info">
                <a href="/Profile" class="user-link">
                    <img src="~/img/user-avatar.png" alt="User Avatar" class="user-avatar" />
                    <span class="user-name">ADM</span>
                </a>
            </div>
        </header>

        <!-- Page Content -->
        <div class="content-container admin-statistics-container">
            <div class="admin-statistics-header">
                <h1 class="page-title">ESTATÍSTICAS ADMIN</h1>
                <div class="filters-container">
                    <div class="filter-item">
                        <label for="periodFilter" class="sr-only">Selecionar período de tempo</label>
                        <select class="filter-dropdown" id="periodFilter" aria-label="Selecionar período de tempo">
                            <option selected>Semanal</option>
                            <option>Mensal</option>
                            <option>Trimestral</option>
                            <option>Anual</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label for="teamFilter" class="sr-only">Selecionar equipa</label>
                        <select class="filter-dropdown" id="teamFilter" aria-label="Selecionar equipa">
                            <option selected>Equipa</option>
                            <option>Mark01</option>
                            <option>Dev02</option>
                            <option>HR03</option>
                            <option>Fin04</option>
                            <option>Sup05</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label for="departmentFilter" class="sr-only">Selecionar departamento</label>
                        <select class="filter-dropdown" id="departmentFilter" aria-label="Selecionar departamento">
                            <option selected>Departamento</option>
                            <option>Marketing</option>
                            <option>Desenvolvimento</option>
                            <option>Recursos Humanos</option>
                            <option>Finanças</option>
                            <option>Suporte</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="export-container">
                <button class="export-btn" id="exportDataBtn">
                    <i class="fas fa-file-export"></i> Exportar Relatório
                </button>
            </div>

            <!-- Dashboard Cards -->
            <div class="dashboard-cards">
                <div class="dashboard-card">
                    <div class="card-title">Nº de Utilizadores</div>
                    <div class="card-value">125</div>
                    <div class="card-icon"><i class="fas fa-users"></i></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-title">Média de Humor</div>
                    <div class="card-value">32/40</div>
                    <div class="card-icon"><i class="fas fa-face-smile"></i></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-title">Taxa de Resposta</div>
                    <div class="card-value">87%</div>
                    <div class="card-icon"><i class="fas fa-chart-simple"></i></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-title">Departamentos</div>
                    <div class="card-value">5</div>
                    <div class="card-icon"><i class="fas fa-building"></i></div>
                </div>
            </div>

            <!-- Main Content Area with Charts and Stats -->
            <div class="admin-statistics-content">
                <div class="statistics-summary">
                    <h2>Estatísticas Globais</h2>
                    <ul class="stats-list">
                        <li>Total Horas Trabalhadas: 3840H</li>
                        <li>Tarefas Concluídas: 450</li>
                        <li>Média de humor geral: 32/40</li>
                        <li>Departamento + produtivo: Desenvolvimento</li>
                        <li>Equipa com humor mais elevado: Dev02</li>
                        <li>Horas extra totais: 125H</li>
                        <li>Taxa de participação: 87%</li>
                        <li>Total questionários: 580</li>
                        <li>Utilizadores inativos: 8</li>
                    </ul>
                </div>

                <div class="charts-container">
                    <div class="chart-row">
                        <div class="chart-item">
                            <h3 class="chart-title">Distribuição por Departamento</h3>
                            <canvas id="departmentPieChart"></canvas>
                        </div>
                        <div class="chart-item">
                            <h3 class="chart-title">Média de Humor por Departamento</h3>
                            <canvas id="moodBarChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-item wide">
                            <h3 class="chart-title">Evolução de Humor ao Longo do Período</h3>
                            <canvas id="moodLineChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-item">
                            <h3 class="chart-title">Taxa de Resposta</h3>
                            <canvas id="responseRateChart"></canvas>
                        </div>
                        <div class="chart-item">
                            <h3 class="chart-title">Produtividade por Equipa</h3>
                            <canvas id="productivityChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-item">
                        <h3 class="chart-title">Comparação entre Departamentos</h3>
                        <table class="department-comparison">
                            <thead>
                                <tr>
                                    <th>Departamento</th>
                                    <th>Média Humor</th>
                                    <th>Produtividade</th>
                                    <th>Taxa Resposta</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Marketing</td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 85%"></div>
                                        </div>
                                        <span>34/40</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 70%"></div>
                                        </div>
                                        <span>70%</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 90%"></div>
                                        </div>
                                        <span>90%</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Desenvolvimento</td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 80%"></div>
                                        </div>
                                        <span>32/40</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 95%"></div>
                                        </div>
                                        <span>95%</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 88%"></div>
                                        </div>
                                        <span>88%</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Recursos Humanos</td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 75%"></div>
                                        </div>
                                        <span>30/40</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 65%"></div>
                                        </div>
                                        <span>65%</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 72%"></div>
                                        </div>
                                        <span>72%</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Finanças</td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 70%"></div>
                                        </div>
                                        <span>28/40</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 82%"></div>
                                        </div>
                                        <span>82%</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar high" style="width: 92%"></div>
                                        </div>
                                        <span>92%</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Suporte</td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 65%"></div>
                                        </div>
                                        <span>26/40</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar medium" style="width: 75%"></div>
                                        </div>
                                        <span>75%</span>
                                    </td>
                                    <td>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar low" style="width: 55%"></div>
                                        </div>
                                        <span>55%</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="wellbeing-recommendations">
            <h2 class="recommendations-title">
                <i class="fas fa-lightbulb"></i> Recomendações de Bem-Estar
                <button class="recommendations-info-btn" id="recommendationsInfoBtn" title="Sobre as Recomendações" aria-label="Informações sobre as recomendações">
                    <i class="fas fa-info-circle"></i>
                </button>
            </h2>

            <div class="recommendations-container">
                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <i class="fas fa-clock recommendation-icon"></i>
                        <h3>Pausa Ativa</h3>
                    </div>
                    <p class="recommendation-text">
                        Considere fazer uma pausa de 5 minutos a cada hora de trabalho. Os dados mostram que o período mais produtivo é durante a manhã.
                    </p>
                    <span class="recommendation-tag personal">Pessoal</span>
                </div>

                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <i class="fas fa-users recommendation-icon"></i>
                        <h3>Dinâmica de Equipa</h3>
                    </div>
                    <p class="recommendation-text">
                        A sua equipa está com níveis de humor abaixo da média. Considere realizar uma reunião para alinhar expectativas e melhorar o ambiente.
                    </p>
                    <span class="recommendation-tag team">Equipa</span>
                </div>

                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <i class="fas fa-building recommendation-icon"></i>
                        <h3>Gestão de Carga</h3>
                    </div>
                    <p class="recommendation-text">
                        O departamento de Marketing apresenta sinais de sobrecarga. Considere redistribuir tarefas ou estender prazos para melhorar o bem-estar.
                    </p>
                    <span class="recommendation-tag department">Departamento</span>
                </div>
            </div>

            <button class="view-all-recommendations-btn" id="viewAllRecommendationsBtn" aria-label="Ver todas as recomendações de bem-estar">
                Ver Todas as Recomendações
            </button>
        </div>

        <!-- Recommendations Info Modal -->
        <div id="recommendationsInfoModal" class="modal" role="dialog" aria-labelledby="infoModalTitle" aria-modal="true">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="infoModalTitle" class="modal-title">Sobre as Recomendações</h2>
                    <button class="close-modal" aria-label="Fechar modal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>As recomendações de bem-estar são geradas automaticamente com base em:</p>
                    <ul>
                        <li><strong>Dados de humor:</strong> Obtidos através dos questionários preenchidos</li>
                        <li><strong>Padrões de trabalho:</strong> Horários de entrada/saída e horas trabalhadas</li>
                        <li><strong>Métricas da equipa:</strong> Níveis médios de humor e produtividade</li>
                        <li><strong>Métricas departamentais:</strong> Comparações entre equipas e departamentos</li>
                    </ul>
                    <p>As recomendações são atualizadas semanalmente e não substituem a orientação profissional de saúde mental.</p>
                </div>
            </div>
        </div>

        <!-- All Recommendations Modal -->
        <div id="allRecommendationsModal" class="modal" role="dialog" aria-labelledby="allRecsModalTitle" aria-modal="true">
            <div class="modal-content modal-content-large">
                <div class="modal-header">
                    <h2 id="allRecsModalTitle" class="modal-title">Recomendações de Bem-Estar</h2>
                    <button class="close-modal" aria-label="Fechar modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="recommendations-filter" role="tablist">
                        <button class="filter-btn active" data-filter="all" role="tab" aria-selected="true">Todas</button>
                        <button class="filter-btn" data-filter="personal" role="tab" aria-selected="false">Pessoais</button>
                        <button class="filter-btn" data-filter="team" role="tab" aria-selected="false">Equipa</button>
                        <button class="filter-btn" data-filter="department" role="tab" aria-selected="false">Departamentais</button>
                    </div>

                    <div class="recommendations-grid">
                        <!-- Personal recommendations -->
                        <div class="recommendation-card" data-type="personal">
                            <div class="recommendation-header">
                                <i class="fas fa-clock recommendation-icon"></i>
                                <h3>Pausa Ativa</h3>
                            </div>
                            <p class="recommendation-text">
                                Considere fazer uma pausa de 5 minutos a cada hora de trabalho. Os dados mostram que o período mais produtivo é durante a manhã.
                            </p>
                            <span class="recommendation-tag personal">Pessoal</span>
                        </div>

                        <div class="recommendation-card" data-type="personal">
                            <div class="recommendation-header">
                                <i class="fas fa-moon recommendation-icon"></i>
                                <h3>Melhor Descanso</h3>
                            </div>
                            <p class="recommendation-text">
                                O seu padrão de entrada indica possível cansaço matinal. Considere ajustar a rotina de sono para melhorar o descanso.
                            </p>
                            <span class="recommendation-tag personal">Pessoal</span>
                        </div>

                        <div class="recommendation-card" data-type="personal">
                            <div class="recommendation-header">
                                <i class="fas fa-mug-hot recommendation-icon"></i>
                                <h3>Intervalos Regulares</h3>
                            </div>
                            <p class="recommendation-text">
                                Recomenda-se fazer intervalos curtos entre tarefas longas. Considere utilizar a técnica Pomodoro para maior produtividade.
                            </p>
                            <span class="recommendation-tag personal">Pessoal</span>
                        </div>

                        <!-- Team recommendations -->
                        <div class="recommendation-card" data-type="team">
                            <div class="recommendation-header">
                                <i class="fas fa-users recommendation-icon"></i>
                                <h3>Dinâmica de Equipa</h3>
                            </div>
                            <p class="recommendation-text">
                                A sua equipa está com níveis de humor abaixo da média. Considere realizar uma reunião para alinhar expectativas e melhorar o ambiente.
                            </p>
                            <span class="recommendation-tag team">Equipa</span>
                        </div>

                        <div class="recommendation-card" data-type="team">
                            <div class="recommendation-header">
                                <i class="fas fa-calendar recommendation-icon"></i>
                                <h3>Almoços em Equipa</h3>
                            </div>
                            <p class="recommendation-text">
                                As equipas que fazem refeições juntas regularmente reportam maior sentido de pertença. Considere organizar um almoço em grupo.
                            </p>
                            <span class="recommendation-tag team">Equipa</span>
                        </div>

                        <div class="recommendation-card" data-type="team">
                            <div class="recommendation-header">
                                <i class="fas fa-comments recommendation-icon"></i>
                                <h3>Comunicação Eficaz</h3>
                            </div>
                            <p class="recommendation-text">
                                Os dados indicam oportunidade para melhorar a comunicação interna. Considere implementar reuniões semanais mais curtas e objetivas.
                            </p>
                            <span class="recommendation-tag team">Equipa</span>
                        </div>

                        <!-- Department recommendations -->
                        <div class="recommendation-card" data-type="department">
                            <div class="recommendation-header">
                                <i class="fas fa-building recommendation-icon"></i>
                                <h3>Gestão de Carga</h3>
                            </div>
                            <p class="recommendation-text">
                                O departamento de Marketing apresenta sinais de sobrecarga. Considere redistribuir tarefas ou estender prazos para melhorar o bem-estar.
                            </p>
                            <span class="recommendation-tag department">Departamento</span>
                        </div>

                        <div class="recommendation-card" data-type="department">
                            <div class="recommendation-header">
                                <i class="fas fa-clipboard-list recommendation-icon"></i>
                                <h3>Gestão de Expectativas</h3>
                            </div>
                            <p class="recommendation-text">
                                Os dados indicam que as expectativas de produtividade podem estar muito elevadas. Considere rever metas com a liderança.
                            </p>
                            <span class="recommendation-tag department">Departamento</span>
                        </div>

                        <div class="recommendation-card" data-type="department">
                            <div class="recommendation-header">
                                <i class="fas fa-handshake recommendation-icon"></i>
                                <h3>Colaboração Interdepartamental</h3>
                            </div>
                            <p class="recommendation-text">
                                Os dados mostram oportunidades de melhoria na colaboração entre Marketing e Desenvolvimento. Considere sessões de alinhamento.
                            </p>
                            <span class="recommendation-tag department">Departamento</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="home-footer">
            <div class="footer-content">
                <div class="copyright">EmotiWork - 2025</div>
                <div class="privacy-policy">
                    <a href="/Privacy" class="privacy-link">Proteção de Dados</a>
                </div>
            </div>
        </footer>
    </main>

    <script>
        // Define a more accessible color palette
        const colorPalette = {
            blue: 'rgb(46, 134, 193)',
            blueLight: 'rgba(46, 134, 193, 0.2)',
            green: 'rgb(13, 110, 30)',
            greenLight: 'rgba(13, 110, 30, 0.2)',
            amber: 'rgb(179, 108, 0)',
            amberLight: 'rgba(179, 108, 0, 0.2)',
            red: 'rgb(192, 57, 43)',
            redLight: 'rgba(192, 57, 43, 0.2)',
            purple: 'rgb(142, 68, 173)',
            purpleLight: 'rgba(142, 68, 173, 0.2)'
        };

        // Sample data for charts (static mockup)
        document.addEventListener('DOMContentLoaded', function() {
            // Department Distribution Chart
            const deptCtx = document.getElementById('departmentPieChart').getContext('2d');
            const deptChart = new Chart(deptCtx, {
                type: 'pie',
                data: {
                    labels: ['Marketing', 'Desenvolvimento', 'Recursos Humanos', 'Finanças', 'Suporte'],
                    datasets: [{
                        data: [15, 35, 20, 18, 12],
                        backgroundColor: [
                            colorPalette.red,
                            colorPalette.blue,
                            colorPalette.amber,
                            colorPalette.green,
                            colorPalette.purple
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });

            // Mood Bar Chart
            const moodBarCtx = document.getElementById('moodBarChart').getContext('2d');
            const moodBarChart = new Chart(moodBarCtx, {
                type: 'bar',
                data: {
                    labels: ['Marketing', 'Desenvolvimento', 'RH', 'Finanças', 'Suporte'],
                    datasets: [{
                        label: 'Média de Humor (/40)',
                        data: [34, 32, 30, 28, 26],
                        backgroundColor: colorPalette.blue,
                        borderColor: colorPalette.blue,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 40
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Line Chart for Mood Over Time
            const lineCtx = document.getElementById('moodLineChart').getContext('2d');
            const lineChart = new Chart(lineCtx, {
                type: 'line',
                data: {
                    labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho'],
                    datasets: [{
                        label: 'Marketing',
                        data: [30, 32, 31, 33, 34, 34],
                        borderColor: colorPalette.red,
                        backgroundColor: 'rgba(192, 57, 43, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Desenvolvimento',
                        data: [28, 30, 31, 32, 31, 32],
                        borderColor: colorPalette.blue,
                        backgroundColor: 'rgba(46, 134, 193, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Recursos Humanos',
                        data: [27, 28, 29, 30, 29, 30],
                        borderColor: colorPalette.amber,
                        backgroundColor: 'rgba(179, 108, 0, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 25,
                            max: 40
                        }
                    }
                }
            });

            // Response Rate Chart
            const responseRateCtx = document.getElementById('responseRateChart').getContext('2d');
            const responseRateChart = new Chart(responseRateCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Responderam', 'Não Responderam'],
                    datasets: [{
                        data: [87, 13],
                        backgroundColor: [
                            colorPalette.green,
                            '#6c757d' // Keep gray for non-responses
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Productivity Chart
            const productivityCtx = document.getElementById('productivityChart').getContext('2d');
            const productivityChart = new Chart(productivityCtx, {
                type: 'radar',
                data: {
                    labels: ['Mark01', 'Dev02', 'HR03', 'Fin04', 'Sup05'],
                    datasets: [{
                        label: 'Produtividade',
                        data: [70, 95, 65, 82, 75],
                        backgroundColor: colorPalette.blueLight,
                        borderColor: colorPalette.blue,
                        borderWidth: 2,
                        pointBackgroundColor: colorPalette.blue
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });
        });

        // Recommendations functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Info modal functionality
            const infoModal = document.getElementById('recommendationsInfoModal');
            const infoBtn = document.getElementById('recommendationsInfoBtn');
            const infoModalClose = infoModal.querySelector('.close-modal');

            infoBtn.addEventListener('click', function() {
                infoModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });

            infoModalClose.addEventListener('click', function() {
                infoModal.style.display = 'none';
                document.body.style.overflow = '';
            });

            // All recommendations modal functionality
            const allRecsModal = document.getElementById('allRecommendationsModal');
            const allRecsBtn = document.getElementById('viewAllRecommendationsBtn');
            const allRecsModalClose = allRecsModal.querySelector('.close-modal');

            allRecsBtn.addEventListener('click', function() {
                allRecsModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });

            allRecsModalClose.addEventListener('click', function() {
                allRecsModal.style.display = 'none';
                document.body.style.overflow = '';
            });

            // Filter recommendations
            const filterBtns = document.querySelectorAll('.filter-btn');
            const recommendationCards = document.querySelectorAll('.recommendations-grid .recommendation-card');

            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active button
                    filterBtns.forEach(b => {
                        b.classList.remove('active');
                        b.setAttribute('aria-selected', 'false');
                    });
                    this.classList.add('active');
                    this.setAttribute('aria-selected', 'true');

                    const filter = this.getAttribute('data-filter');

                    // Show/hide cards based on filter
                    recommendationCards.forEach(card => {
                        if (filter === 'all' || card.getAttribute('data-type') === filter) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            });

            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === infoModal) {
                    infoModal.style.display = 'none';
                    document.body.style.overflow = '';
                }
                if (e.target === allRecsModal) {
                    allRecsModal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            });

            // Close modals with escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (infoModal.style.display === 'block') {
                        infoModal.style.display = 'none';
                        document.body.style.overflow = '';
                    }
                    if (allRecsModal.style.display === 'block') {
                        allRecsModal.style.display = 'none';
                        document.body.style.overflow = '';
                    }
                }
            });
        });
    </script>
</body>
</html>
